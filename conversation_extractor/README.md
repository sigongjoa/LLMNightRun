# Claude 대화 추출 도구

이 도구는 OCR과 OpenCV를 활용하여 Claude와의 대화를 자동으로 추출하고 저장하는 프로그램입니다. 스크린샷을 수동으로 찍을 필요 없이 실시간으로 대화를 모니터링하고 저장할 수 있습니다.

## 주요 기능

- **자동 화면 캡처**: 지정된 화면 영역을 주기적으로 캡처하여 대화 내용을 추출
- **실시간 모니터링**: 캡처된 이미지에서 OCR을 사용하여 실시간으로 대화 내용 추출
- **이미지에서 대화 추출**: 저장된 스크린샷에서 대화 내용을 추출
- **자동 저장**: 추출된 대화를 JSON 또는 텍스트 파일로 자동 저장
- **간편한 UI**: 사용자 친화적인 인터페이스로 쉽게 사용 가능

## 설치 및 실행 방법

### 1. 설치 요구사항

- Python 3.7 이상
- [Tesseract OCR](https://github.com/UB-Mannheim/tesseract/wiki) (필수 외부 프로그램)

### 2. 실행하기

실행하는 방법은 간단합니다:

1. `run.py` 파일을 더블클릭하거나 명령 프롬프트에서 다음 명령을 실행합니다:
   ```
   python run.py
   ```

2. 처음 실행 시 필요한 라이브러리(OpenCV, PyTesseract, PIL, NumPy, PyAutoGUI)가 자동으로 설치됩니다.

### 3. Tesseract OCR 설치하기

프로그램을 사용하기 전에 반드시 Tesseract OCR을 설치해야 합니다:

1. [Tesseract OCR 다운로드 페이지](https://github.com/UB-Mannheim/tesseract/wiki)에서 최신 버전을 다운로드합니다.
2. 설치 시 **추가 언어 데이터** 옵션에서 **한국어(Korean)** 언어 패키지를 선택하여 설치합니다.
3. 기본 설치 경로는 `C:\Program Files\Tesseract-OCR\`입니다.
4. 프로그램 설정 탭에서 설치된 Tesseract OCR 경로를 확인하고 필요시 수정합니다.

## 사용 방법

### 자동 캡처 기능

1. "자동 캡처" 탭을 선택합니다.
2. "캡처 영역 선택" 버튼을 클릭하고 화면에서 Claude 대화창이 보이는 영역을 드래그하여 선택합니다.
3. "캡처 시작" 버튼을 클릭하여 자동 캡처를 시작합니다.
4. 프로그램이 선택된 영역을 주기적으로 캡처하고 OCR로 텍스트를 추출합니다.
5. 추출된 대화가 하단 텍스트 박스에 표시됩니다.
6. "캡처 중지" 버튼을 클릭하여 캡처를 일시 중지할 수 있습니다.
7. "대화 저장" 버튼을 클릭하여 현재까지 추출된 대화를 파일로 저장합니다.

### 이미지에서 대화 추출

1. "이미지에서 추출" 탭을 선택합니다.
2. "찾아보기" 버튼을 클릭하여 대화가 포함된 이미지 파일을 선택합니다.
3. "대화 추출" 버튼을 클릭하면 이미지에서 대화가 추출됩니다.
4. 추출된 대화를 저장할지 여부를 선택할 수 있습니다.

### 설정

1. "설정" 탭에서 다음 설정을 변경할 수 있습니다:
   - Tesseract OCR 경로
   - 출력 폴더 위치
   - 대화 파일명
   - 캡처 간격 (초)
2. "설정 저장" 버튼을 클릭하여 변경사항을 저장합니다.

## 문제 해결

1. **"Tesseract OCR을 찾을 수 없습니다"** 오류
   - Tesseract OCR이
 올바르게 설치되었는지 확인하세요.
   - 설정 탭에서 Tesseract 실행 파일 경로가 올바른지 확인하세요.

2. **대화가 제대로 추출되지 않는 경우**
   - 이미지 품질이 좋은지 확인하세요.
   - 캡처 영역이 대화 내용만 포함하도록 조정하세요.
   - 대화 내용의 글꼴이 선명하고 배경과 대비가 뚜렷한지 확인하세요.

3. **프로그램이 실행되지 않는 경우**
   - Python이 올바르게 설치되어 있는지 확인하세요.
   - `run.py`를 실행하여 필요한 라이브러리가 자동으로 설치되도록 하세요.

## 제한 사항

- OCR 기술의 한계로 인해 모든 텍스트가 완벽하게 인식되지 않을 수 있습니다.
- 복잡한 배경이나 특수 폰트가 있는 화면은 인식률이 낮을 수 있습니다.
- 캡처 간격이 너무 짧으면 시스템 리소스 사용량이 증가할 수 있습니다.

## 팁

- 최상의 결과를 위해 Tesseract OCR 최신 버전을 사용하세요.
- 화면 해상도가 높을수록 OCR 인식률이 향상됩니다.
- 캡처 간격은 대화 속도에 맞게 조정하세요. 일반적으로 3~5초가 적당합니다.
